modelo_teams5=yearID~+Win+Lost+E
teams_arbol5=tree(modelo_teams5,data=entrena)
summary(teams_arbol5)
plot(teams_arbol5) ; text(teams_arbol5)
modelo_teams6=yearID~+Win+Lost+E+LgWin+CG
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
modelo_teams6=yearID~+Win+Lost+LgWin
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
modelo_teams6=LgWin~+Win+Lost+R
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
modelo_teams6=LgWin~+Win+Lost+R+E+SB+H
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
library(rattle)
install.packages(rattle)
install.packages(rattle)
install.packages("rattle")
install.packages("rpart.plot")
install.packages("RColorBrewer")
install.packages("rpart")
library(rattle)
library(rattle)
library(rpart.plot)
library(RColorBrewer)
library(rpart)
modelo <- rpart(LeaguegWin~R+E+SB+H+SO+RA+SB, data=Teams2, method = "class")
modelo <- rpart(LgWin~R+E+SB+H+SO+RA+SB, data=Teams2, method = "class")
plot(modelo)
text(modelo)
modelo <- rpart(LgWin~R+E+SB+H+SO+RA+SB, data=Teams, method = "class")
plot(modelo)
text(modelo)
prediccion <- predict(modelo, testTeams, type="class")
prediccion <- predict(modelo, type="class")
submit <- data.frame(idTeam=Teams$teamIDBR, LgWin=prediccion)
submit <- data.frame(idTeam=Teams$teamID, LgWin=prediccion)
entrena=Teams2[ind==1,]
test=Teams2[ind==2]
test=Teams2[ind==2,]
arbolTeams=rpart(modelo,data=entrena)
entrena=Teams2[ind==1,]
test=Teams2[ind==2,]
arbolTeams=rpart(modelo,data=entrena)
modelo <- rpart(LgWin~R+E+SB+H+SO+RA+SB, data=Teams, method = "class")
arbolTeams=rpart(modelo,data=entrena)
arbol3=rpart(modelo,data=entrena)
ind=sample(2,nrow(iris),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
test=Teams2[ind==2,]
arbolTeams=rpart(modelo,data=entrena)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
test=Teams2[ind==2,]
modelo <- rpart(LgWin~R+E+SB+H+SO+RA+SB, data=Teams, method = "class")
arbolTeams=rpart(modelo,data=entrena)
submit <- data.frame(idTeam=Teams$teamID, LgWin=prediccion)
prediccion <- predict(modelo, type="class")
submit <- data.frame(idTeam=Teams$teamID, LgWin=prediccion)
prediccion <- predict(modelo, Teams3, type="class")
prediccion <- predict(modelo, type="class")
submit <- data.frame(idTeam=Teams$teamID, LgWin=prediccion)
submit <- data.frame(idTeam=Teams$yearID, LgWin=prediccion)
arbol3=rpart(modelo,data=entrena)
View(entrena)
arbol3=rpart(modelo,data="entrena")
library(rpart)
arbol3=rpart(modelo,data="entrena")
arbol3=rpart(modelo,data=entrena)
require(rpart)
arbol3=rpart(modelo,data=entrena)
arbol3=rpart(modelo,data="entrena")
install.packages("rpart.utils")
install.packages("rpart")
install.packages("rpart.utils")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
library(rpart)
modelo <- rpart(LgWin~R+E+SB+H+SO+RA+SB, data=Teams, method = "class")
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
test=Teams2[ind==2,]
arbol3=rpart(modelo,data=entrena)
prediccion <- predict(modelo, type="class")
submit <- data.frame(idTeam = Teams$teamID, LgWin=prediccion)
modelo = LgWin~R+E+SB+H+SO+RA+SB
lirary(tree)
library(tree)
arbol_Teams=tree(modelo, data=Teams2)
summary(arbol_Teams)
plot(arbol_Teams)
text(arbol_Teams)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
arbol_Teams=tree(modelo, data=entrena)
summary(arbol_Teams)
plot(arbol_Teams)
text(arbol_Teams)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
modelo = LgWin~R+E+SB+H+SO+RA+SB
arbol_Teams=tree(modelo, data=entrena)
summary(arbol_Teams)
ind=sample(2,nrow(Teams),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams[ind==1,]
modelo = LgWin~R+E+SB+H+SO+RA+SB
arbol_Teams=tree(modelo, data=entrena)
summary(arbol_Teams)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
test=Teams2[ind==2,]
modelo = LgWin~R+E+SB+H+SO+RA+SB
library(tree)
arbol2=tree(modelo,data=entrena)
summary(arbol2)
summary(arbol2)
summary(arbol2)
summary(arbol2)
summary(arbol2)
arbol2=tree(modelo,data=entrena)
summary(arbol2)
modelo = LgWin~R+E+SB+H+SO+RA
arbol2=tree(modelo,data=entrena)
summary(arbol2)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
entrena=Teams2[ind==1,]
modelo = LgWin~R+E+SB+H+SO+RA
arbol2=tree(modelo,data=entrena)
summary(arbol2)
modelo=LgWin~R+E+SB+H+SO+RA+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
modelo_teams6=LgWin~R+E+SB+H+SO+RA+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6) ; text(teams_arbol6)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.75,0.25))
entrena=Teams2[ind==1,]
modelo_teams6=LgWin~R+E+SB+H+SO+RA+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.65,0.35))
entrena=Teams2[ind==1,]
modelo_teams6=LgWin~R+E+SB+H+SO+RA+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
ind=sample(2,nrow(Teams2),replace=TRUE,prob=c(0.7,0.3))
modelo_teams6=LgWin~R+E+SB+H+SO+RA+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
entrena=Teams2[ind==1,]
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~SO+RA+R+E+SB+H
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=yearID~+Win+Lost+LgWin
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SHO+RA
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA+G
teams_arbol6=tree(modelo_teams6,data=entrena)
modelo_teams6=LgWin~R+E+SB+H+SO+RA+Games
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+RA+Games+CG
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+Games+CG
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO+Games+CG
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+RA+E+SB+H+SO+Games+CG
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6);text(teams_arbol6)
modelo_teams6=LgWin~R+RA+E+SB+H+SO
teams_arbol6=ctree(modelo_teams6,data=entrena)
library(ctree)
install.packages(ctree)
install.packages("ctree")
View(Teams2)
modelo_teams6=LgWin~R+RA+E+SB+H+SO
teams_arbol6=ctree(modelo_teams6,data=entrena)
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
teams_arbol6=rpart(modelo_teams6,data=entrena)
summary(teams_arbol6)
plot(teams_arbol6);text(teams_arbol6)
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+RA+E+SB+H+SO+SB
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+SB+H+SO
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
modelo_teams6=LgWin~R+E+RA+SB+H+SO
write.csv(Teams2, file="/Users/jesusgarciamanday/Desktop/Teams2.csv")
teams_arbol6=tree(modelo_teams6,data=entrena)
modelo_teams6=LgWin~R+E+RA+SB+H+SO
teams_arbol6=tree(modelo_teams6,data=entrena)
summary(teams_arbol6)
library(rpart)
library(rpart.plot)
modelo = rpart(LgWin ~ R + E + RA + SB + H + SO, data=Teams2, method="class")
plot(modelo)
text(modelo)
fancyRpartPlot(modelo)
library(rattle)
library(RColorBrewer)
fancyRpartPlot(modelo)
Prediction <- predict(modelo, titanicTest, type = "class")
teamsTest=Teams2
Prediction <- predict(modelo, teamsTest, type = "class")
teamsTest=Teams
Prediction <- predict(modelo, teamsTest, type = "class")
submit <- data.frame(teamIDId = teamsTest$teamID, LgWin = Prediction)
submit <- data.frame(teamId = teamsTest$teamID, LgWin = Prediction)
write.csv(submit, file = "/Users/jesusgarciamanday/Desktop/Master/TID/Proyecto/arbol.csv", row.names = FALSE)
table(prediccion,teamsTest$teamID)
ind=sample(2,nrow(teamsTest),replace=TRUE,prob=c(0.7,0.3))
test=teamsTest[ind==2,]
table(prediccion,test$teamID)
printcp(modelo)
modelo
Teams3 = with(Teams, data.frame(Teams$yearID, Teams$teamID, Teams$lgID, Teams$G, Teams$W, Teams$L, Teams$LgWin, Teams$R, Teams$AB, Teams$H, Teams$SO, Teams$SB, Teams$RA, Teams$CG, Teams$SHO, Teams$E, Teams$name))
names(Teams3) = c("yearID", "teamID", "lgID", "Games", "Win", "Lost", "LgWin", "R", "AB", "H", "SO", "SB", "RA", "CG", "SHO", "E", "name")
View(Teams3)
ind=sample(2,nrow(Teams3),replace=TRUE,prob=c(0.7,0.3))
entrenaTeams = Teams3[ind==1,]
testTeams = Teams3[ind==2,]
indice = sample(2, row(Teams3), replace=TRUE, prob=c(0.7, 0.3))
entrenaTeams = Teams3[indice==1,]
testTeams = Teams3[indice==2,]
modeloTeams = LgWin ~ R + E + SB + H + SO + RA + SB
modeloTeams = LgWin ~ R + E + SB + H + SO + RA + SB
modeloTeams = LgWin ~ R + E + SB + H + SO + RA + SB
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
indice = sample(2, row(Teams2), replace=TRUE, prob=c(0.7, 0.3))
testTeams = Teams2[indice==2,]
entrenaTeams = Teams2[indice==1,]
modeloTeams = LgWin ~ R + E + SB + H + SO + RA + SB
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
arbolTeams2 = rpart(modeloTeams, data=entrenaTeams, parms = list(split="information")
)
arbolTeams2 = rpart(modeloTeams, data=entrenaTeams, parms = list(split="information"))
plot(arbolTeams); text(arbolTeams)
plot(arbolTeams2); text(arbolTeams2)
table(predict(arbolTeams,type="class"),entrenaTeams$LgWin)
prediccion = predict(modeloTeams, testTeams, type="class")
prediccion <- predict(modeloTeams, testTeams, type="class")
prediccion = predict(modeloTeams, testTeams, type="class")
prediccion = predict(modeloTeams, testTeams)
myModel = lm(modeloTeams, data = entrenaTeams)
prediccion = predict(myModel, testTeams, type="class")
prediccion = predict(myModel, testTeams)
table(predict(arbolTeams,type="class"),entrenaTeams$LgWin)
table(predict(myModel,type="class"),entrenaTeams$LgWin)
table(predict(myModel),entrenaTeams$LgWin)
table(predict(myModel, testTeams),entrenaTeams$LgWin)
prediccion = predict(myModel, testTeams)
mc = table(prediccion, entrenaTeams$LgWin)
mc = table(testTeams[, "LgWin"], prediccion)
rpart.plot(modeloTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[modeloTeams$LgWin])
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
testpred=predict(arbolTeams,newdata=testTeams,type="class")
table(testpred,testTeams$LgWin)
tt=table(testpred,testTeams$LgWin)
tt
dd=diag(tt)
bien=sum(dd)
bien_clasificados=(bien/nrow(test))*100
bien_rparty=bien_clasificados
bien_clasificados
100-bien_clasificados
modeloTeams = LgWin ~ R + E + SB + H + SO + RA + CG
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams)
text(arbolTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
modeloTeams = LgWin ~ R + SB + CG
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams);text(arbolTeams)
plot(arbolTeams);text(arbolTeams)
modeloTeams = LgWin ~ R + SB + CG
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams)
modeloTeams = LgWin ~ R + SB + CG + E
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams)
modeloTeams = LgWin ~ R + SB + CG + E + RA
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams)
text(arbolTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
modeloTeams = LgWin ~ R + E + RA
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
plot(arbolTeams)
text(arbolTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
modeloTeams = LgWin ~ R + E + RA + H
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
modeloTeams = LgWin ~ R + E + RA + H + SB
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
plot(arbolTeams)
text(arbolTeams)
modeloTeams = LgWin ~ R + E + RA + H + SO
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams)
text(arbolTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
modeloTeams = LgWin ~ R + RA + H + SO
arbolTeams = rpart(modeloTeams, data=entrenaTeams)
plot(arbolTeams)
text(arbolTeams)
rpart.plot(arbolTeams, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams$LgWin])
plot(arbolTeams)
text(arbolTeams)
plot(lgID, Win)
plot(Teams2$lgID, Teams2$Win)
rplot(Teams2$lgID, Teams2$Win)
plot(Teams2$lgID, Teams2$Win)
hist(Teams2$lgID, Teams2$Win)
modeloTeams5 = LgWin ~ R + H + SO + RA
arbolTeams5 = rpart(modeloTeams5, data=entrenaTeams)
plot(arbolTeams5); text(arbolTeams5)
rpart.plot(arbolTeams5, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams5$LgWin])
modeloTeams10 = LgWin ~ R + lgID + RA + H + SO
arbolTeams10 = rpart(modeloTeams10, data=entrenaTeams)
plot(arbolTeams10); text(arbolTeams10)
rpart.plot(arbolTeams10, type=1, extra=100, cex=.7, box.col=c("gray99", "gray88")[arbolTeams10$LgWin])
View(Teams2)
View(Teams)
plot(Teams)
barplot(Teams)
hist(Teams)
hist(Teams$franchID, Teams$Rank)
hist(Teams$BB, Teams$Rank)
hist(Teams$ERA, Teams$Rank)
barplot(Teams$ERA, Teams$Rank)
plot(Teams$ERA, Teams$Rank)
View(Teams)
plot(Media de carreras perdidas <- Teams$ERA, Teams$Rank)
Teams4 = with(Teams, data.frame(Teams$Rank, Teams$ERA, Teams$Ghome))
Teams4 = with(Teams, data.frame(Teams$BB, Teams$ERA))
plot(Teams$ERA, Teams$BB)
plot(Teams$ERA, Teams$PPF)
Teams4 = with(Teams, data.frame(Teams$PPF, Teams$ERA))
name(Teams4) = c("Factor de 3 años para los lanzadores", "Media de carreras ganadas")
names(Teams4) = c("Factor de 3 años para los lanzadores", "Media de carreras ganadas")
plot(Teams$ERA, Teams$PPF)
plot(Teams4$ERA, Teams4$PPF)
plot(Teams4$`Factor de 3 años para los lanzadores`, Teams4$`Media de carreras ganadas`)
plot(Factor de 3 años para los lanzadores, Media de carreras ganadas)
plot(Teams4$Factor de 3 años para los lanzadores, Teams4$Media de carreras ganadas)
clearPushBack()
clear()
View(abstencion)
View(datos2)
View(datos2)
View(abstencion)
View(abstencion)
View(abstencion)
View(abstencion)
View(abstencion)
rm(list=ls())
a <- 7
b <- 8
a+b
v <- c(2, 3, b, a)
q <- v + 1
library("gtools", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
install.packages("ggplot2")
require(ggplot2)
a <- 7
b <- 8
v <- c(2, 3, b, a)
a <- 7
b <- 8
v <- c(2, 3, b, a)
w <- 1:5
w <- -2:5
df <- data.frame(q,x,y)
df <- data.frame(q, x, y)
q <- c("Futbol", "Baloncesto", "Tenis", "Balonmano")
x <- 1:4
y <- -2:1
df <- data.frame(q, x, y)
View(df)
names(df) <- c("Deportes", "Var_X", "Var_Y")
setwd("~/Desktop/Master/SIGE/Practicas/Practica1/dataset")
train <- read.csv("train.csv")
test <- read.csv("test.csv")
fit <- rpart(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked, data=train, method="class")
Prediction <- predict(fit, test, type = "class")
library(rpart)
fit <- rpart(Survived ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked, data=train, method="class")
Prediction <- predict(fit, test, type = "class")
submit <- data.frame(PassengerId = test$PassengerId, Survived = Prediction)
write.csv(submit, file = "myfirstdtree.csv", row.names = FALSE)
Prediction <- predict(fit, test, type = "class")
submit <- data.frame(PassengerId = test$PassengerId, Survived = Prediction)
write.csv(submit, file = "decisiontree.csv", row.names = FALSE)
str(train)
train <- read.csv("train.csv")
train <- read.csv("train.csv")
train <- read.csv("train.csv")
train <- read.csv("train.csv")
test <- read.csv("test.csv")
library(rpart)
install.packages('randomForest')
library(randomForest)
install.packages('party')
library(party)
test$Survived <- NA
combi <- rbind(train, test)
combi$Name <- as.character(combi$Name)
combi$Title <- sapply(combi$Name, FUN=function(x) {strsplit(x, split='[,.]')[[1]][2]})
combi$Title <- sub(' ', '', combi$Title)
combi$Title[combi$Title %in% c('Mme', 'Mlle')] <- 'Mlle'
combi$Title[combi$Title %in% c('Capt', 'Don', 'Major', 'Sir')] <- 'Sir'
combi$Title[combi$Title %in% c('Dona', 'Lady', 'the Countess', 'Jonkheer')] <- 'Lady'
combi$Title <- factor(combi$Title)
combi$FamilySize <- combi$SibSp + combi$Parch + 1
combi$Surname <- sapply(combi$Name, FUN=function(x) {strsplit(x, split='[,.]')[[1]][1]})
combi$FamilyID <- paste(as.character(combi$FamilySize), combi$Surname, sep="")
combi$FamilyID[combi$FamilySize <= 2] <- 'Small'
famIDs <- data.frame(table(combi$FamilyID))
famIDs <- famIDs[famIDs$Freq <= 2,]
combi$FamilyID[combi$FamilyID %in% famIDs$Var1] <- 'Small'
combi$FamilyID <- factor(combi$FamilyID)
summary(combi$Age)
Agefit <- rpart(Age ~ Pclass + Sex + SibSp + Parch + Fare + Embarked + Title + FamilySize,
data=combi[!is.na(combi$Age),], method="anova")
combi$Age[is.na(combi$Age)] <- predict(Agefit, combi[is.na(combi$Age),])
summary(combi)
summary(combi$Embarked)
which(combi$Embarked == '')
combi$Embarked[c(62,830)] = "S"
combi$Embarked <- factor(combi$Embarked)
summary(combi$Fare)
which(is.na(combi$Fare))
combi$Fare[1044] <- median(combi$Fare, na.rm=TRUE)
combi$FamilyID2 <- combi$FamilyID
combi$FamilyID2 <- as.character(combi$FamilyID2)
combi$FamilyID2[combi$FamilySize <= 3] <- 'Small'
combi$FamilyID2 <- factor(combi$FamilyID2)
train <- combi[1:891,]
test <- combi[892:1309,]
li# Build Random Forest Ensemble
set.seed(415)
fit <- randomForest(as.factor(Survived) ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked + Title + FamilySize + FamilyID2,
data=train, importance=TRUE, ntree=2000)
str(train)
varImpPlot(fit)
Prediction <- predict(fit, test)
submit <- data.frame(PassengerId = test$PassengerId, Survived = Prediction)
write.csv(submit, file = "reaturestree.csv", row.names = FALSE)
str(train)
set.seed(415)
fit <- cforest(as.factor(Survived) ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked + Title + FamilySize + FamilyID,
data = train, controls=cforest_unbiased(ntree=2000, mtry=3))
str(train)
View(train)
set.seed(415)
fit <- cforest(as.factor(Survived) ~ Pclass + Sex + Age + SibSp + Parch + Fare + Embarked + Title + FamilySize + FamilyID,
data = train, controls=cforest_unbiased(ntree=2000, mtry=3))
Prediction <- predict(fit, test, OOB=TRUE, type = "response")
submit <- data.frame(PassengerId = test$PassengerId, Survived = Prediction)
write.csv(submit, file = "randomforest.csv", row.names = FALSE)
str(train)
summary(Prediction)
